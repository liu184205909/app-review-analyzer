# ğŸ“— App Review Analyzer - å¼€å‘æŒ‡å—

> AIé©±åŠ¨çš„åº”ç”¨è¯„è®ºåˆ†æå¹³å°å®Œæ•´å¼€å‘æ–‡æ¡£
> **æœ€åæ›´æ–°ï¼š** 2025-11-11
> **ç‰ˆæœ¬ï¼š** v2.1 (åŒ…å«ç”¨æˆ·ç³»ç»Ÿå’Œå…è´¹æ•°æ®æºé›†æˆ)

---

## ğŸ“‹ ç›®å½•

1. [é¡¹ç›®æ¦‚è¿°](#é¡¹ç›®æ¦‚è¿°)
2. [ç¯å¢ƒå‡†å¤‡](#ç¯å¢ƒå‡†å¤‡)
3. [é¡¹ç›®å®‰è£…](#é¡¹ç›®å®‰è£…)
4. [ç¯å¢ƒé…ç½®](#ç¯å¢ƒé…ç½®)
5. [æ•°æ®åº“é…ç½®](#æ•°æ®åº“é…ç½®)
6. [å¯åŠ¨é¡¹ç›®](#å¯åŠ¨é¡¹ç›®)
7. [é¡¹ç›®ç»“æ„](#é¡¹ç›®ç»“æ„)
8. [æ ¸å¿ƒåŠŸèƒ½å¼€å‘](#æ ¸å¿ƒåŠŸèƒ½å¼€å‘)
9. [ç”¨æˆ·ç³»ç»Ÿå¼€å‘](#ç”¨æˆ·ç³»ç»Ÿå¼€å‘)
10. [å…è´¹æ•°æ®æºé›†æˆ](#å…è´¹æ•°æ®æºé›†æˆ)
11. [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)
12. [éƒ¨ç½²æŒ‡å—](#éƒ¨ç½²æŒ‡å—)
13. [å¼€å‘æœ€ä½³å®è·µ](#å¼€å‘æœ€ä½³å®è·µ)

---

## ğŸ¯ é¡¹ç›®æ¦‚è¿°

App Review Analyzer æ˜¯ä¸€ä¸ªä¼ä¸šçº§çš„åº”ç”¨è¯„è®ºåˆ†æå¹³å°ï¼Œåˆ©ç”¨AIæŠ€æœ¯ä»iOS App Storeå’ŒGoogle Playå•†åº—æå–ç”¨æˆ·è¯„è®ºï¼Œæä¾›æ·±åº¦æ´å¯Ÿå’Œç«äº‰åˆ†æã€‚

### âœ¨ æ ¸å¿ƒåŠŸèƒ½
- ğŸ¤– **AIæ™ºèƒ½åˆ†æ** - è‡ªåŠ¨åˆ†æç”¨æˆ·è¯„è®ºï¼Œè¯†åˆ«å…³é”®é—®é¢˜å’Œéœ€æ±‚
- ğŸ“± **å¤šå¹³å°æ”¯æŒ** - æ”¯æŒiOS App Storeå’ŒGoogle Play Store
- ğŸ‘¥ **ç”¨æˆ·ç³»ç»Ÿ** - å®Œæ•´çš„æ³¨å†Œã€ç™»å½•ã€è®¢é˜…ç®¡ç†
- ğŸ’° **ä»˜è´¹ä½“ç³»** - ä¸‰å±‚è®¢é˜…æ¨¡å¼ï¼ŒåŠŸèƒ½å·®å¼‚åŒ–
- ğŸ† **ç«å“å¯¹æ¯”** - å¤šåº”ç”¨åŒæ—¶å¯¹æ¯”åˆ†æ
- ğŸ“Š **æ•°æ®å¯¼å‡º** - PDF/CSV/JSONæ ¼å¼å¯¼å‡º
- ğŸ“§ **é‚®ä»¶é€šçŸ¥** - åˆ†æå®Œæˆå®æ—¶é€šçŸ¥
- âš¡ **æ€§èƒ½ä¼˜åŒ–** - ä¼ä¸šçº§æ€§èƒ½ç›‘æ§å’Œä¼˜åŒ–
- ğŸ†“ **å…è´¹æ•°æ®æº** - 2000+è¯„è®ºï¼Œé›¶æˆæœ¬è·å–

### ğŸ—ï¸ æŠ€æœ¯æ ˆ

#### å‰ç«¯
- **æ¡†æ¶**: Next.js 14 (App Router)
- **è¯­è¨€**: TypeScript
- **æ ·å¼**: Tailwind CSS
- **çŠ¶æ€ç®¡ç†**: React Hooks + Zustand
- **ç»„ä»¶åº“**: è‡ªå®šä¹‰ç»„ä»¶ç³»ç»Ÿ

#### åç«¯
- **API**: Next.js API Routes
- **æ•°æ®åº“**: PostgreSQL + Prisma ORM
- **è®¤è¯**: JWT + bcryptjs
- **æ”¯ä»˜**: Stripe (Webhookå¤„ç†)
- **é‚®ä»¶**: Nodemailer + SMTP
- **ç¼“å­˜**: æ™ºèƒ½ç¼“å­˜ç³»ç»Ÿ

#### æ•°æ®æº
- **App Store**: RSS Feeds (å…è´¹)
- **Google Play**: Scraper + Developer API (å…è´¹)
- **ç¬¬ä¸‰æ–¹**: AppFollowing, 42matters (å¯é€‰)
- **ç»Ÿä¸€æŠ“å–å™¨**: æ™ºèƒ½æ•°æ®æºé€‰æ‹©å’Œè´¨é‡è¯„ä¼°

---

## ğŸ”§ ç¯å¢ƒå‡†å¤‡

### å¿…éœ€è½¯ä»¶
- **Node.js**: 18.x æˆ–æ›´é«˜ç‰ˆæœ¬
- **npm** æˆ– **yarn**
- **Git**
- **PostgreSQL**: 14+ æ•°æ®åº“
- **ä»£ç ç¼–è¾‘å™¨**: VS Codeï¼ˆæ¨èï¼‰

### å¼€å‘å·¥å…·æ¨è
- **VS Code æ‰©å±•**:
  - Prisma
  - Tailwind CSS
  - GitLens
  - Prettier
  - ES7+ React/Redux/React-Native snippets

---

## ğŸš€ é¡¹ç›®å®‰è£…

```bash
# 1. å…‹éš†é¡¹ç›®
git clone <repository-url>
cd app-review-analyzer

# 2. å®‰è£…ä¾èµ–
npm install

# 3. é…ç½®ç¯å¢ƒå˜é‡
cp .env.example .env.local

# 4. æ•°æ®åº“è®¾ç½®
npx prisma migrate dev

# 5. å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev
```

---

## âš™ï¸ ç¯å¢ƒé…ç½®

### æ ¸å¿ƒç¯å¢ƒå˜é‡ (`.env.local`)

```env
# æ•°æ®åº“è¿æ¥
DATABASE_URL="postgresql://username:password@localhost:5432/app-review-analyzer"

# AI æœåŠ¡é…ç½®
OPENROUTER_API_KEY="your-openrouter-api-key"
OPENAI_API_KEY="your-openai-api-key" # å¯é€‰

# JWT è®¤è¯
JWT_SECRET="your-super-secret-jwt-key"
JWT_EXPIRES_IN="7d"

# Stripe æ”¯ä»˜ç³»ç»Ÿ
STRIPE_SECRET_KEY="sk_test_..."
STRIPE_WEBHOOK_SECRET="whsec_..."
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY="pk_test_..."

# é‚®ä»¶æœåŠ¡ (Gmailç¤ºä¾‹)
SMTP_HOST="smtp.gmail.com"
SMTP_PORT="587"
SMTP_USER="your-email@gmail.com"
SMTP_PASS="your-app-password"
SMTP_FROM='"App Review Analyzer" <noreply@appreviewanalyzer.com>"

# åº”ç”¨é…ç½®
NEXT_PUBLIC_APP_URL="http://localhost:3000"
NEXTAUTH_URL="http://localhost:3000"

# å…è´¹æ•°æ®æºå¢å¼º (å¯é€‰)
GOOGLE_PLAY_API_KEY="your-google-play-developer-api-key"
APPFOLLOWING_API_KEY="your-appfollowing-api-key"
APPLE_STORE_API_KEY_ID="your-app-store-api-key-id"
APPLE_STORE_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\n...\n-----END PRIVATE KEY-----"
```

### API å¯†é’¥è·å–æŒ‡å—

#### 1. **OpenRouter API** (å¿…éœ€)
```bash
# è®¿é—® https://openrouter.ai
# æ³¨å†Œè´¦æˆ·å¹¶è·å– API Key
# æ”¯æŒå¤šç§ AI æ¨¡å‹ (Claude, GPT-4, Llama, ç­‰)
```

#### 2. **Stripe æ”¯ä»˜** (å¿…éœ€)
```bash
# è®¿é—® https://dashboard.stripe.com
# æ³¨å†Œè´¦æˆ·å¹¶è·å–å¯†é’¥
# é…ç½® Webhook ç«¯ç‚¹
```

#### 3. **Google Play Developer API** (å¯é€‰ï¼Œæå‡æ•°æ®è´¨é‡)
```bash
# è®¿é—® https://console.developers.google.com
# å¯ç”¨ Google Play Developer API
# åˆ›å»ºæœåŠ¡è´¦å·å¯†é’¥
```

#### 4. **AppFollowing API** (å¯é€‰ï¼Œé¢å¤–1000æ¬¡/æœˆ)
```bash
# è®¿é—® https://appfollowing.com
# æ³¨å†Œå…è´¹è´¦æˆ·
# è·å– API Key
```

---

## ğŸ—„ï¸ æ•°æ®åº“é…ç½®

### Prisma ORM æ“ä½œ

```bash
# ç”Ÿæˆ Prisma Client
npx prisma generate

# è¿è¡Œæ•°æ®åº“è¿ç§»
npx prisma migrate dev

# é‡ç½®æ•°æ®åº“ï¼ˆå¼€å‘ç¯å¢ƒï¼‰
npx prisma migrate reset

# æ‰“å¼€æ•°æ®åº“ç®¡ç†ç•Œé¢
npx prisma studio

# æ¨é€æ¨¡å¼æ›´æ”¹åˆ°æ•°æ®åº“
npx prisma db push
```

### æ ¸å¿ƒæ•°æ®æ¨¡å‹

```typescript
// ç”¨æˆ·ç³»ç»Ÿæ¨¡å‹
User {
  id: string (UUID)
  email: string (unique)
  passwordHash: string
  name: string
  subscriptionTier: free | professional | team
  monthlyAnalysisCount: number
  stripeCustomerId?: string
  emailNotifications: boolean
  createdAt: DateTime
  updatedAt: DateTime
}

// åˆ†æä»»åŠ¡æ¨¡å‹
AnalysisTask {
  id: string (UUID)
  userId?: string (å…³è”ç”¨æˆ·)
  taskType: single | compare
  status: pending | processing | completed | failed
  platform: ios | android
  appStoreId: string
  appSlug: string
  result: Json (åˆ†æç»“æœ)
  progress: number
  isLatest: boolean
  createdAt: DateTime
  completedAt?: DateTime
}

// åº”ç”¨ä¿¡æ¯æ¨¡å‹
App {
  id: string
  platform: ios | android
  appId: string
  name: string
  bundleId: string
  iconUrl: string
  rating: number
  reviewCount: number
  developer: string
  category: string
  lastCrawledAt: DateTime
}

// è¯„è®ºæ•°æ®æ¨¡å‹
Review {
  id: string (UUID)
  appId: string (å…³è”App)
  platform: ios | android
  reviewId: string (å¹³å°åŸå§‹ID)
  author: string
  rating: number (1-5)
  title: string
  content: string
  reviewDate: DateTime
  appVersion: string
  helpfulCount: number
  country: string
  language: string
  sentiment: positive | negative | neutral
  aiTags: string[]
}
```

---

## ğŸƒâ€â™‚ï¸ å¯åŠ¨é¡¹ç›®

### å¼€å‘å‘½ä»¤

```bash
# å¼€å‘æœåŠ¡å™¨
npm run dev

# æ„å»ºç”Ÿäº§ç‰ˆæœ¬
npm run build

# å¯åŠ¨ç”Ÿäº§æœåŠ¡å™¨
npm start

# æ•°æ®åº“æ“ä½œ
npm run db:generate    # ç”Ÿæˆ Prisma Client
npm run db:migrate     # è¿è¡Œè¿ç§»
npm run db:reset       # é‡ç½®æ•°æ®åº“
npm run db:studio      # æ‰“å¼€ Prisma Studio

# ä»£ç è´¨é‡
npm run lint          # ESLintæ£€æŸ¥
npm run type-check    # TypeScriptç±»å‹æ£€æŸ¥
```

---

## ğŸ“‚ é¡¹ç›®ç»“æ„

```
app-review-analyzer/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app/                    # Next.js App Router
â”‚   â”‚   â”œâ”€â”€ (home)/            # é¦–é¡µè·¯ç”±ç»„
â”‚   â”‚   â”œâ”€â”€ api/               # API è·¯ç”±
â”‚   â”‚   â”‚   â”œâ”€â”€ auth/          # è®¤è¯ç›¸å…³API
â”‚   â”‚   â”‚   â”œâ”€â”€ analyze/       # åˆ†æAPI
â”‚   â”‚   â”‚   â”œâ”€â”€ data-sources/  # æ•°æ®æºæŸ¥è¯¢API
â”‚   â”‚   â”‚   â”œâ”€â”€ stripe/        # æ”¯ä»˜API
â”‚   â”‚   â”‚   â””â”€â”€ user/          # ç”¨æˆ·API
â”‚   â”‚   â”œâ”€â”€ analysis/          # åˆ†æç»“æœé¡µé¢
â”‚   â”‚   â”œâ”€â”€ browse/            # åº”ç”¨æµè§ˆé¡µé¢
â”‚   â”‚   â”œâ”€â”€ compare/           # ç«å“å¯¹æ¯”é¡µé¢
â”‚   â”‚   â”œâ”€â”€ dashboard/         # ç”¨æˆ·ä»ªè¡¨æ¿
â”‚   â”‚   â”œâ”€â”€ login/             # ç™»å½•é¡µé¢
â”‚   â”‚   â”œâ”€â”€ pricing/           # ä»·æ ¼é¡µé¢
â”‚   â”‚   â””â”€â”€ register/          # æ³¨å†Œé¡µé¢
â”‚   â”œâ”€â”€ components/            # React ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ ui/                # åŸºç¡€UIç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ ReviewList.tsx     # è¯„è®ºåˆ—è¡¨ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ AnalysisCard.tsx   # åˆ†æå¡ç‰‡ç»„ä»¶
â”‚   â”‚   â””â”€â”€ ExportDropdown.tsx # å¯¼å‡ºç»„ä»¶
â”‚   â”œâ”€â”€ lib/                   # å·¥å…·åº“
â”‚   â”‚   â”œâ”€â”€ auth.ts            # è®¤è¯å·¥å…·
â”‚   â”‚   â”œâ”€â”€ prisma.ts          # æ•°æ®åº“è¿æ¥
â”‚   â”‚   â”œâ”€â”€ scrapers/          # æ•°æ®æŠ“å–æ¨¡å—
â”‚   â”‚   â”‚   â”œâ”€â”€ unified-reviews.ts  # ç»Ÿä¸€æŠ“å–å™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ app-store.ts         # App StoreæŠ“å–
â”‚   â”‚   â”‚   â””â”€â”€ google-play.ts       # Google PlayæŠ“å–
â”‚   â”‚   â”œâ”€â”€ ai/               # AI åˆ†ææ¨¡å—
â”‚   â”‚   â”‚   â””â”€â”€ openrouter.ts        # OpenRouteré›†æˆ
â”‚   â”‚   â”œâ”€â”€ email.ts          # é‚®ä»¶æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ stripe.ts         # Stripeé›†æˆ
â”‚   â”‚   â””â”€â”€ performance.ts    # æ€§èƒ½ç›‘æ§
â”‚   â”œâ”€â”€ middleware.ts         # è·¯ç”±ä¸­é—´ä»¶
â”‚   â””â”€â”€ types/                 # TypeScript ç±»å‹å®šä¹‰
â”œâ”€â”€ prisma/
â”‚   â”œâ”€â”€ schema.prisma          # æ•°æ®åº“æ¨¡å¼
â”‚   â””â”€â”€ migrations/            # æ•°æ®åº“è¿ç§»æ–‡ä»¶
â”œâ”€â”€ docs/                      # æ–‡æ¡£ç›®å½•
â”œâ”€â”€ public/                    # é™æ€èµ„æº
â””â”€â”€ .env.example              # ç¯å¢ƒå˜é‡æ¨¡æ¿
```

---

## ğŸ’» æ ¸å¿ƒåŠŸèƒ½å¼€å‘

### 1. ç»Ÿä¸€è¯„è®ºæŠ“å–å™¨

```typescript
// src/lib/scrapers/unified-reviews.ts
import { unifiedReviewScraper } from '@/lib/scrapers/unified-reviews';

// ä½¿ç”¨ç¤ºä¾‹
const result = await unifiedReviewScraper.getReviews(
  'com.instagram.android',  // åº”ç”¨ID
  'android',                // å¹³å°
  2000,                     // ç›®æ ‡è¯„è®ºæ•°
  {
    country: 'us',
    language: 'en',
    deepMode: true
  }
);

console.log({
  reviews: result.reviews.length,
  source: result.source,
  quality: result.quality
});
```

### 2. AI åˆ†æé›†æˆ

```typescript
// src/lib/ai/openrouter.ts
export async function analyzeSingleApp(reviews: Review[]) {
  const prompt = `
    åˆ†æä»¥ä¸‹åº”ç”¨è¯„è®ºæ•°æ®ï¼š

    ${reviews.map(r => `
      è¯„åˆ†: ${r.rating}/5
      ä½œè€…: ${r.author}
      å†…å®¹: ${r.content}
      ç‰ˆæœ¬: ${r.appVersion}
    `).join('\n---\n')}

    è¯·æä¾›ï¼š
    1. æ•´ä½“æƒ…æ„Ÿåˆ†æ (æ­£é¢/è´Ÿé¢/ä¸­æ€§æ¯”ä¾‹)
    2. ç”¨æˆ·æœ€å…³å¿ƒçš„é—®é¢˜
    3. åŠŸèƒ½è¯·æ±‚å’Œå»ºè®®
    4. ç‰ˆæœ¬ç›¸å…³é—®é¢˜
    5. ç«å“å¯¹æ¯”åˆ†æ
  `;

  return await openrouter.chat.completions.create({
    model: "anthropic/claude-3-haiku",
    messages: [{ role: "user", content: prompt }]
  });
}
```

### 3. ç”¨æˆ·è®¤è¯ç³»ç»Ÿ

```typescript
// src/lib/auth.ts
import jwt from 'jsonwebtoken';
import bcrypt from 'bcryptjs';

// ç”ŸæˆJWT Token
export function generateToken(user: {
  id: string;
  email: string;
  subscriptionTier: string;
}): string {
  const payload = {
    userId: user.id,
    email: user.email,
    subscriptionTier: user.subscriptionTier,
  };

  return jwt.sign(payload, process.env.JWT_SECRET!, {
    expiresIn: process.env.JWT_EXPIRES_IN || '7d'
  });
}

// æ£€æŸ¥ç”¨æˆ·åˆ†ææƒé™
export async function canUserAnalyze(userId: string): Promise<{
  canAnalyze: boolean;
  reason?: string;
  remainingAnalyses?: number;
  subscriptionTier: string;
}> {
  const user = await prisma.user.findUnique({
    where: { id: userId }
  });

  if (!user) return { canAnalyze: false, reason: 'User not found', subscriptionTier: 'free' };

  if (user.subscriptionTier === 'professional' || user.subscriptionTier === 'team') {
    return { canAnalyze: true, subscriptionTier: user.subscriptionTier };
  }

  // å…è´¹ç”¨æˆ·é™åˆ¶
  if (user.monthlyAnalysisCount >= 3) {
    return {
      canAnalyze: false,
      reason: 'Monthly limit exceeded',
      remainingAnalyses: 0,
      subscriptionTier: 'free'
    };
  }

  return {
    canAnalyze: true,
    remainingAnalyses: 3 - user.monthlyAnalysisCount,
    subscriptionTier: 'free'
  };
}
```

---

## ğŸ‘¥ ç”¨æˆ·ç³»ç»Ÿå¼€å‘

### 1. ç”¨æˆ·æ³¨å†ŒAPI

```typescript
// src/app/api/auth/register/route.ts
import { z } from 'zod';

const registerSchema = z.object({
  email: z.string().email(),
  password: z.string().min(8),
  name: z.string().min(2),
});

export async function POST(request: NextRequest) {
  const body = await request.json();
  const { email, password, name } = registerSchema.parse(body);

  // æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²å­˜åœ¨
  const existingUser = await prisma.user.findUnique({
    where: { email }
  });

  if (existingUser) {
    return NextResponse.json(
      { error: 'User already exists' },
      { status: 400 }
    );
  }

  // å¯†ç åŠ å¯†
  const passwordHash = await bcrypt.hash(password, 12);

  // åˆ›å»ºç”¨æˆ·
  const user = await prisma.user.create({
    data: {
      email,
      passwordHash,
      name,
      subscriptionTier: 'free',
      monthlyAnalysisCount: 0,
    }
  });

  // ç”ŸæˆJWT Token
  const token = generateToken(user);

  return NextResponse.json({
    user: {
      id: user.id,
      email: user.email,
      name: user.name,
      subscriptionTier: user.subscriptionTier,
    },
    token
  });
}
```

### 2. Stripeæ”¯ä»˜é›†æˆ

```typescript
// src/app/api/stripe/checkout/route.ts
import Stripe from 'stripe';

const stripe = new Stripe(process.env.STRIPE_SECRET_KEY!);

export async function POST(request: NextRequest) {
  const { userId, priceId } = await request.json();

  const session = await stripe.checkout.sessions.create({
    customer_email: userEmail,
    billing_address_collection: 'required',
    line_items: [
      {
        price: priceId, // 'price_1...' (Professional: $29/mo, Team: $99/mo)
        quantity: 1,
      },
    ],
    mode: 'subscription',
    success_url: `${process.env.NEXT_PUBLIC_APP_URL}/subscription/success`,
    cancel_url: `${process.env.NEXT_PUBLIC_APP_URL}/pricing`,
    metadata: {
      userId,
    },
  });

  return NextResponse.json({ url: session.url });
}
```

---

## ğŸ†“ å…è´¹æ•°æ®æºé›†æˆ

### 1. ç»Ÿä¸€æŠ“å–å™¨ä½¿ç”¨

```typescript
// æ–°çš„é›†æˆæ–¹å¼ - æ›¿æ¢åŸæœ‰çš„æŠ“å–é€»è¾‘
import { unifiedReviewScraper } from '@/lib/scrapers/unified-reviews';

// åœ¨ analyze API ä¸­ä½¿ç”¨
const unifiedResult = await unifiedReviewScraper.getReviews(
  appId,
  platform,
  2000, // ç›®æ ‡è¯„è®ºæ•°
  {
    country: options?.country || 'us',
    language: options?.language || 'en',
    deepMode: true,
  }
);

console.log(`æ•°æ®æº: ${unifiedResult.source}, è´¨é‡: ${unifiedResult.quality}`);
```

### 2. æ•°æ®æºçŠ¶æ€æŸ¥è¯¢

```bash
# æŸ¥è¯¢å¯ç”¨æ•°æ®æº
curl http://localhost:3000/api/data-sources

# è¿”å›ç¤ºä¾‹:
{
  "dataSources": {
    "available": ["appstore_rss", "google_play_scraper"],
    "quality": {
      "appstore_rss": 0.8,
      "google_play_scraper": 0.7
    },
    "costs": {
      "appstore_rss": "Free",
      "google_play_scraper": "Free"
    }
  },
  "statistics": {
    "totalSources": 5,
    "availableSources": 2,
    "freeSources": 5
  }
}
```

### 3. ç¯å¢ƒé…ç½®å¢å¼º

```env
# å¯é€‰çš„å¢å¼ºæ•°æ®æº (æå‡æ•°æ®è´¨é‡å’Œæ•°é‡)
GOOGLE_PLAY_API_KEY="your-google-play-developer-api-key"    # è´¨é‡æå‡è‡³0.95
APPFOLLOWING_API_KEY="your-appfollowing-api-key"           # é¢å¤–1000æ¬¡/æœˆ
APPLE_STORE_API_KEY_ID="your-app-store-api-key-id"        # iOSæ•°æ®è´¨é‡æå‡
```

---

## ğŸš¨ å¸¸è§é—®é¢˜

### æ•°æ®åº“è¿æ¥é—®é¢˜

```bash
# æ£€æŸ¥æ•°æ®åº“è¿æ¥
npx prisma db pull

# é‡ç½®æ•°æ®åº“
npx prisma migrate reset

# æ£€æŸ¥è¿æ¥å­—ç¬¦ä¸²
echo $DATABASE_URL
```

### API è¶…æ—¶é—®é¢˜

```typescript
// ä½¿ç”¨ AbortController å¤„ç†è¶…æ—¶
const controller = new AbortController();
const timeoutId = setTimeout(() => controller.abort(), 30000);

try {
  const response = await fetch(url, {
    signal: controller.signal,
    headers: { 'User-Agent': 'App Review Analyzer' }
  });
  clearTimeout(timeoutId);
  return response;
} catch (error) {
  clearTimeout(timeoutId);
  throw new Error('Request timeout');
}
```

### AI åˆ†æé”™è¯¯å¤„ç†

```typescript
// é™çº§å¤„ç†ç­–ç•¥
export async function safeAnalyzeReviews(reviews: Review[]) {
  try {
    const analysis = await analyzeSingleApp(reviews);
    return analysis;
  } catch (error) {
    console.error('AIåˆ†æå¤±è´¥ï¼Œä½¿ç”¨åŸºç¡€åˆ†æ:', error);

    // é™çº§åˆ°åŸºç¡€ç»Ÿè®¡åˆ†æ
    return {
      sentiment: calculateBasicSentiment(reviews),
      issues: extractCommonIssues(reviews),
      features: extractFeatureRequests(reviews),
      fallback: true
    };
  }
}
```

### ç”¨æˆ·è®¤è¯é—®é¢˜

```typescript
// ä¸­é—´ä»¶é…ç½® - src/middleware.ts
export async function middleware(request: NextRequest) {
  const { pathname } = request.nextUrl;

  // ä¿æŠ¤éœ€è¦è®¤è¯çš„è·¯ç”±
  if (pathname.startsWith('/api/') || pathname.startsWith('/dashboard')) {
    const token = request.headers.get('authorization')?.replace('Bearer ', '');

    if (!token) {
      return NextResponse.redirect(new URL('/login', request.url));
    }

    const payload = verifyToken(token);
    if (!payload) {
      return NextResponse.redirect(new URL('/login', request.url));
    }

    // æ·»åŠ ç”¨æˆ·ä¿¡æ¯åˆ°è¯·æ±‚å¤´
    const response = NextResponse.next();
    response.headers.set('x-user-id', payload.userId);
    return response;
  }

  return NextResponse.next();
}
```

---

## ğŸš€ éƒ¨ç½²æŒ‡å—

### Vercel éƒ¨ç½² (æ¨è)

```bash
# 1. å®‰è£… Vercel CLI
npm i -g vercel

# 2. éƒ¨ç½²é¡¹ç›®
vercel

# 3. é…ç½®ç¯å¢ƒå˜é‡
vercel env add DATABASE_URL
vercel env add OPENROUTER_API_KEY
vercel env add JWT_SECRET
vercel env add STRIPE_SECRET_KEY

# 4. è®¾ç½®æ•°æ®åº“ (ä½¿ç”¨ Supabase æˆ– Railway)
# æ¨è: https://supabase.com
```

### Docker éƒ¨ç½²

```dockerfile
# Dockerfile
FROM node:18-alpine

WORKDIR /app

# å¤åˆ¶ä¾èµ–æ–‡ä»¶
COPY package*.json ./
RUN npm ci --only=production

# å¤åˆ¶æºä»£ç 
COPY . .

# ç”Ÿæˆ Prisma Client
RUN npx prisma generate

# æ„å»ºåº”ç”¨
RUN npm run build

EXPOSE 3000

CMD ["npm", "start"]
```

```yaml
# docker-compose.yml
version: '3.8'
services:
  app:
    build: .
    ports:
      - "3000:3000"
    environment:
      - DATABASE_URL=postgresql://user:password@postgres:5432/appreview
    depends_on:
      - postgres

  postgres:
    image: postgres:14
    environment:
      - POSTGRES_USER=user
      - POSTGRES_PASSWORD=password
      - POSTGRES_DB=appreview
    volumes:
      - postgres_data:/var/lib/postgresql/data

volumes:
  postgres_data:
```

### ç¯å¢ƒå˜é‡é…ç½® (ç”Ÿäº§)

```bash
# ç”Ÿäº§ç¯å¢ƒå¿…é¡»å˜é‡
DATABASE_URL=                    # æ•°æ®åº“è¿æ¥
OPENROUTER_API_KEY=              # AIæœåŠ¡
JWT_SECRET=                      # JWTå¯†é’¥ (å¼ºéšæœºå­—ç¬¦ä¸²)
STRIPE_SECRET_KEY=               # Stripeæ”¯ä»˜
STRIPE_WEBHOOK_SECRET=           # Stripe Webhook
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=  # Stripeå‰ç«¯å¯†é’¥

# é‚®ä»¶æœåŠ¡
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@domain.com
SMTP_PASS=your-app-password

# åº”ç”¨URL
NEXT_PUBLIC_APP_URL=https://your-domain.com
NEXTAUTH_URL=https://your-domain.com

# å¯é€‰å¢å¼º (æå‡æ•°æ®è´¨é‡)
GOOGLE_PLAY_API_KEY=
APPFOLLOWING_API_KEY=
```

---

## ğŸ” æµ‹è¯•æŒ‡å—

### API æµ‹è¯•

```bash
# å¥åº·æ£€æŸ¥
curl http://localhost:3000/api/health

# æ•°æ®æºçŠ¶æ€
curl http://localhost:3000/api/data-sources

# ç”¨æˆ·æ³¨å†Œæµ‹è¯•
curl -X POST http://localhost:3000/api/auth/register \
  -H "Content-Type: application/json" \
  -d '{"email":"test@example.com","password":"password123","name":"Test User"}'

# åˆ†ææµ‹è¯• (éœ€è¦è®¤è¯)
curl -X POST http://localhost:3000/api/analyze \
  -H "Authorization: Bearer YOUR_JWT_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"appUrl":"https://apps.apple.com/us/app/instagram/id389801252","platform":"ios"}'
```

### æ€§èƒ½æµ‹è¯•

```bash
# å®‰è£…æµ‹è¯•å·¥å…·
npm install -g artillery

# è¿è¡Œè´Ÿè½½æµ‹è¯•
artillery run load-test.yml

# load-test.yml ç¤ºä¾‹
config:
  target: 'http://localhost:3000'
  phases:
    - duration: 60
      arrivalRate: 10
scenarios:
  - name: "API Health Check"
    requests:
      - get:
          url: "/api/health"
```

---

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

### 1. æ•°æ®åº“ä¼˜åŒ–

```sql
-- æ·»åŠ å…³é”®ç´¢å¼•
CREATE INDEX idx_review_appId_date ON Review(appId, reviewDate);
CREATE INDEX idx_task_status_created ON AnalysisTask(status, createdAt);
CREATE INDEX idx_user_email_tier ON User(email, subscriptionTier);
CREATE INDEX idx_app_platform_bundleId ON App(platform, bundleId);
```

### 2. ç¼“å­˜ç­–ç•¥

```typescript
// æ™ºèƒ½ç¼“å­˜é…ç½®
function getCacheDuration(reviewCount: number): number {
  if (reviewCount > 50000) return 1;   // 1å¤© - è¶…çƒ­é—¨åº”ç”¨
  if (reviewCount > 10000) return 3;   // 3å¤© - çƒ­é—¨åº”ç”¨
  if (reviewCount > 1000) return 7;    // 7å¤© - æ™®é€šåº”ç”¨
  if (reviewCount > 100) return 30;    // 30å¤© - å°ä¼—åº”ç”¨
  return 90;                           // 90å¤© - æå°ä¼—åº”ç”¨
}
```

### 3. ä»£ç åˆ†å‰²

```typescript
// åŠ¨æ€å¯¼å…¥å¤§å‹ç»„ä»¶
const AnalysisDashboard = dynamic(
  () => import('../components/AnalysisDashboard'),
  {
    loading: () => <div>åŠ è½½åˆ†æé¢æ¿...</div>,
    ssr: false
  }
);

const WordCloud = dynamic(
  () => import('../components/WordCloud'),
  {
    loading: () => <div>ç”Ÿæˆè¯äº‘ä¸­...</div>
  }
);
```

---

## ğŸ”— ç›¸å…³èµ„æº

### æŠ€æœ¯æ–‡æ¡£
- [Next.js 14 æ–‡æ¡£](https://nextjs.org/docs)
- [Prisma æ–‡æ¡£](https://www.prisma.io/docs)
- [Tailwind CSS æ–‡æ¡£](https://tailwindcss.com/docs)
- [Stripe API æ–‡æ¡£](https://stripe.com/docs/api)

### æ•°æ®æºæ–‡æ¡£
- [Google Play Developer API](https://developers.google.com/android-publisher)
- [App Store RSS Feeds](https://developer.apple.com/news/)
- [OpenRouter API](https://openrouter.ai/docs)

### ç¤ºä¾‹é¡¹ç›®
- [Next.js AI Chatbot](https://github.com/vercel/ai-chatbot)
- [Prisma SaaS Starter](https://github.com/prisma/saas-starter)

---

## ğŸ“ è·å–å¸®åŠ©

### å¼€å‘æ”¯æŒ
- **GitHub Issues**: [é¡¹ç›®Issuesé¡µé¢]
- **æ–‡æ¡£æ›´æ–°**: å¼€å‘è¿‡ç¨‹ä¸­åŒæ­¥æ›´æ–°æœ¬æ–‡æ¡£
- **æŠ€æœ¯äº¤æµ**: é¡¹ç›®å†…éƒ¨è®¨è®ºç¾¤

### å¿«é€Ÿè¯Šæ–­

```bash
# æ£€æŸ¥é¡¹ç›®çŠ¶æ€
npm run health-check

# æŸ¥çœ‹æ‰€æœ‰ç¯å¢ƒå˜é‡
npm run env-check

# æ•°æ®åº“è¿æ¥æµ‹è¯•
npm run db-test

# ä¾èµ–å®‰å…¨æ£€æŸ¥
npm audit
```

---

## ğŸ“ æ›´æ–°æ—¥å¿—

### v2.1 (2025-11-11)
- âœ… é›†æˆç»Ÿä¸€å…è´¹æ•°æ®æºç³»ç»Ÿ
- âœ… è¯„è®ºæ•°é‡ä»1500æå‡åˆ°2000+
- âœ… æ·»åŠ æ•°æ®æºè´¨é‡è¯„ä¼°
- âœ… å®Œå–„ç”¨æˆ·ç³»ç»Ÿå’Œä»˜è´¹åŠŸèƒ½

### v2.0 (2025-11-06)
- âœ… å®Œæ•´ç”¨æˆ·è®¤è¯ç³»ç»Ÿ
- âœ… ä¸‰å±‚ä»˜è´¹è®¢é˜…æ¨¡å¼
- âœ… Stripeæ”¯ä»˜é›†æˆ
- âœ… é‚®ä»¶é€šçŸ¥ç³»ç»Ÿ

### v1.0 (2025-09-15)
- âœ… åŸºç¡€è¯„è®ºåˆ†æåŠŸèƒ½
- âœ… iOS/Androidå¹³å°æ”¯æŒ
- âœ… AIæ™ºèƒ½åˆ†æ
- âœ… åŸºç¡€UIç•Œé¢

---

**æ–‡æ¡£ç‰ˆæœ¬**: v2.1
**æœ€åæ›´æ–°**: 2025-11-11
**ä¸‹æ¬¡æ›´æ–°**: åŠŸèƒ½è¿­ä»£ååŒæ­¥